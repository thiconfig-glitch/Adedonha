<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super App Casal - Vers√£o B√≠blica üìñ</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root {
            --cor-primaria: #6aaa64;
            --cor-roxo: #bd00ff;
            --cor-azul: #00f3ff;
            --cor-rosa: #ff0055;
            --cor-ouro: #ffd700;
            --cor-card: rgba(255, 255, 255, 0.08);
            --bg-gradiente: linear-gradient(135deg, #1a0b2e 0%, #2b1055 100%);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--bg-gradiente);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* HEADER */
        header {
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky; top: 0; z-index: 100;
        }

        .logo { 
            font-family: 'Orbitron'; font-weight: 900; 
            background: linear-gradient(90deg, var(--cor-azul), var(--cor-rosa));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* MENU */
        #menu-principal {
            display: flex; flex-direction: column; align-items: center;
            padding: 20px; gap: 15px; width: 100%; max-width: 600px; margin: 0 auto;
        }

        .card-jogo {
            background: var(--cor-card); border: 1px solid rgba(255,255,255,0.1);
            width: 100%; padding: 20px; border-radius: 15px;
            display: flex; align-items: center; cursor: pointer; transition: 0.3s;
        }
        .card-jogo:active { transform: scale(0.98); background: rgba(255,255,255,0.15); }
        .card-icon { font-size: 2.5rem; margin-right: 15px; min-width: 50px; text-align: center; }
        .card-info h3 { font-family: 'Orbitron'; color: var(--cor-azul); margin-bottom: 5px; }
        .card-info p { font-size: 0.9rem; color: #aaa; }

        /* TELAS */
        .tela-jogo {
            display: none; flex: 1; flex-direction: column;
            padding: 20px; align-items: center; width: 100%; max-width: 500px; margin: 0 auto;
        }
        .tela-jogo.ativa { display: flex; animation: slideUp 0.4s ease-out; }
        @keyframes slideUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

        /* MODAL DE AVISO (O PULO DO GATO) */
        #modal-aviso {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.9); z-index: 999;
            display: none; justify-content: center; align-items: center; flex-direction: column;
            backdrop-filter: blur(5px);
        }
        #modal-aviso.show { display: flex; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        
        @keyframes popIn { from{transform:scale(0.5); opacity:0;} to{transform:scale(1); opacity:1;} }

        .aviso-box {
            background: #1a1a2e; border: 2px solid var(--cor-azul);
            padding: 30px; border-radius: 20px; text-align: center; width: 85%; max-width: 320px;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.2);
        }
        .aviso-titulo { font-family: 'Orbitron'; font-size: 1.8rem; margin-bottom: 10px; color: white; }
        .aviso-msg { font-size: 1.1rem; color: #ccc; margin-bottom: 25px; }

        /* BOT√ïES */
        .btn-acao {
            background: linear-gradient(135deg, var(--cor-roxo), var(--cor-rosa));
            border: none; color: white; padding: 15px 30px; border-radius: 30px;
            font-family: 'Orbitron'; font-weight: bold; font-size: 1rem;
            cursor: pointer; width: 100%; box-shadow: 0 5px 15px rgba(189, 0, 255, 0.3);
        }
        .btn-acao:active { transform: scale(0.95); }
        
        .btn-voltar {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3);
            color: white; padding: 8px 15px; border-radius: 20px; font-size: 0.8rem;
        }

        /* JOGO DA VELHA */
        .velha-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; aspect-ratio: 1; }
        .velha-cell {
            background: rgba(255,255,255,0.1); border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 4rem; font-weight: bold; cursor: pointer;
        }
        .velha-cell.x { color: var(--cor-azul); text-shadow: 0 0 10px var(--cor-azul); }
        .velha-cell.o { color: var(--cor-rosa); text-shadow: 0 0 10px var(--cor-rosa); }

        /* FORCA */
        .forca-vidas { font-size: 1.5rem; margin: 10px 0; color: var(--cor-rosa); letter-spacing: 5px; }
        .forca-palavra { font-size: 2.2rem; letter-spacing: 0.3rem; margin: 20px 0; font-family: monospace; text-align: center; }
        .teclado { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; }
        .tecla {
            width: 32px; height: 42px; background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2); color: white; border-radius: 5px;
            font-weight: bold; font-size: 1rem;
        }
        .tecla:disabled { opacity: 0.2; }

        /* TERMO */
        .termo-grid { display: grid; gap: 5px; margin-bottom: 20px; }
        .termo-row { display: grid; grid-template-columns: repeat(5, 50px); gap: 5px; }
        .termo-box {
            width: 50px; height: 50px; border: 2px solid #444;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; font-weight: bold; text-transform: uppercase;
        }
        .certo { background: var(--cor-primaria); border-color: var(--cor-primaria); }
        .lugar { background: #c9b458; border-color: #c9b458; }
        .errado { background: #3a3a3c; border-color: #3a3a3c; }

        /* LOGIN */
        #tela-login {
            position: fixed; top:0; left:0; width:100%; height:100%; background: #151520; z-index: 200;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .avatar { font-size: 3.5rem; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div id="modal-aviso">
        <div class="aviso-box">
            <div id="aviso-icone" style="font-size: 4rem; margin-bottom: 15px;">üèÜ</div>
            <div id="aviso-titulo" class="aviso-titulo">TITULO</div>
            <div id="aviso-msg" class="aviso-msg">Mensagem aqui</div>
            <button class="btn-acao" onclick="fecharModalEReiniciar()">JOGAR NOVAMENTE</button>
        </div>
    </div>

    <div id="tela-login">
        <h1 style="font-family:'Orbitron'; margin-bottom:40px; color:var(--cor-azul);">QUEM √â VOC√ä?</h1>
        <div style="display:flex; gap:20px;">
            <div onclick="fazerLogin('THIAGO')" style="background:var(--cor-card); padding:20px; border-radius:15px; text-align:center; border:1px solid #444;">
                <div class="avatar">ü§µüèª‚Äç‚ôÇÔ∏è</div>
                <h3>THIAGO</h3>
            </div>
            <div onclick="fazerLogin('SAMELLA')" style="background:var(--cor-card); padding:20px; border-radius:15px; text-align:center; border:1px solid #444;">
                <div class="avatar">üë∞üèª‚Äç‚ôÄÔ∏è</div>
                <h3>S√ÇMELLA</h3>
            </div>
        </div>
    </div>

    <header id="app-header" class="hidden">
        <div class="logo">APP B√çBLICO üìñ</div>
        <button class="btn-voltar hidden" id="btn-voltar" onclick="voltarMenu()">MENU</button>
    </header>

    <div id="menu-principal" class="hidden">
        <p style="color:#aaa; text-align:center;">Conectado como: <strong id="lbl-nome" style="color:white;">...</strong></p>
        
        <div class="card-jogo" onclick="abrirJogo('adedonha')">
            <div class="card-icon">üìù</div>
            <div class="card-info"><h3>ADEDONHA</h3><p>Stop B√≠blico e Geral</p></div>
        </div>

        <div class="card-jogo" onclick="abrirJogo('velha')">
            <div class="card-icon">‚≠ï</div>
            <div class="card-info"><h3>JOGO DA VELHA</h3><p>Desafio r√°pido</p></div>
        </div>

        <div class="card-jogo" onclick="abrirJogo('forca')">
            <div class="card-icon">üìñ</div>
            <div class="card-info"><h3>FORCA B√çBLICA</h3><p>Descubra a palavra</p></div>
        </div>

        <div class="card-jogo" onclick="abrirJogo('termo')">
            <div class="card-icon">üü©</div>
            <div class="card-info"><h3>TERMO</h3><p>Adivinhe em 6 chances</p></div>
        </div>
    </div>

    <div id="tela-velha" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-azul); margin-bottom:10px;">JOGO DA VELHA</h2>
        <div id="velha-status" style="margin-bottom:20px; color:#aaa;">Vez de...</div>
        <div class="velha-grid" id="velha-board"></div>
        <button class="btn-acao" style="margin-top:20px; background:#333;" onclick="resetVelha()">REINICIAR TABULEIRO</button>
    </div>

    <div id="tela-forca" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-ouro);">FORCA B√çBLICA</h2>
        <div id="forca-vidas" class="forca-vidas">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        <div id="forca-palavra" class="forca-palavra">_ _ _ _ _</div>
        <div id="forca-teclado" class="teclado"></div>
        <button class="btn-acao" style="margin-top:20px; background:#333;" onclick="resetForca()">NOVA PALAVRA</button>
    </div>

    <div id="tela-termo" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-primaria);">TERMO</h2>
        <div id="termo-grid" class="termo-grid"></div>
        <div style="display:flex; gap:10px;">
            <input type="text" id="termo-input" maxlength="5" style="padding:10px; text-transform:uppercase; text-align:center; width:150px; font-size:1.2rem; border-radius:10px; border:none;">
            <button class="btn-acao" style="width:auto; padding:10px 20px; margin:0;" onclick="chutarTermo()">OK</button>
        </div>
        <button class="btn-acao" style="margin-top:20px; background:#333;" onclick="resetTermo()">REINICIAR</button>
    </div>

    <div id="tela-adedonha" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-roxo);">ADEDONHA</h2>
        <div style="background:#222; padding:30px; border-radius:20px; margin:30px 0; width:100%; text-align:center;">
            <div id="adedonha-letra" style="font-size:5rem; font-weight:bold; color:var(--cor-azul); text-shadow:0 0 20px var(--cor-azul);">?</div>
        </div>
        <button class="btn-acao" onclick="girarAdedonha()">GIRAR LETRA</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAjgEFZB3_FHelXH9YtCnFYFO4RCGO7Wd8",
            authDomain: "adedonha-8b2a4.firebaseapp.com",
            databaseURL: "https://adedonha-8b2a4-default-rtdb.firebaseio.com",
            projectId: "adedonha-8b2a4",
            storageBucket: "adedonha-8b2a4.firebasestorage.app",
            appId: "1:1061633793316:web:e4f9a23ce9e28ae8d2e7b1"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let MEU_NOME = "";
        let JOGO_ATUAL = "";
        let MODAL_ABERTO = false;

        function fazerLogin(nome) {
            MEU_NOME = nome;
            document.getElementById('lbl-nome').innerText = nome;
            document.getElementById('tela-login').style.display = 'none';
            document.getElementById('app-header').classList.remove('hidden');
            document.getElementById('menu-principal').classList.remove('hidden');
        }

        function voltarMenu() {
            document.querySelectorAll('.tela-jogo').forEach(t => t.classList.remove('ativa'));
            document.getElementById('btn-voltar').classList.add('hidden');
            document.getElementById('menu-principal').classList.remove('hidden');
            if(JOGO_ATUAL) db.ref(`games/${JOGO_ATUAL}`).off();
            JOGO_ATUAL = "";
        }

        function abrirJogo(jogo) {
            JOGO_ATUAL = jogo;
            document.getElementById('menu-principal').classList.add('hidden');
            document.getElementById('btn-voltar').classList.remove('hidden');
            document.querySelectorAll('.tela-jogo').forEach(t => t.classList.remove('ativa'));
            document.getElementById(`tela-${jogo}`).classList.add('ativa');

            if(jogo === 'velha') initVelha();
            if(jogo === 'forca') initForca();
            if(jogo === 'termo') initTermo();
            if(jogo === 'adedonha') initAdedonha();
        }

        // === SISTEMA DE AVISO (MODAL) ===
        function mostrarAviso(titulo, msg, icone, corBorda) {
            if(MODAL_ABERTO) return; // Evita abrir v√°rios
            MODAL_ABERTO = true;
            
            document.getElementById('aviso-titulo').innerText = titulo;
            document.getElementById('aviso-msg').innerText = msg;
            document.getElementById('aviso-icone').innerText = icone;
            document.querySelector('.aviso-box').style.borderColor = corBorda;
            
            document.getElementById('modal-aviso').classList.add('show');
        }

        function fecharModalEReiniciar() {
            document.getElementById('modal-aviso').classList.remove('show');
            MODAL_ABERTO = false;
            
            // Reseta o jogo atual automaticamente
            if(JOGO_ATUAL === 'velha') resetVelha();
            if(JOGO_ATUAL === 'forca') resetForca();
            if(JOGO_ATUAL === 'termo') resetTermo();
        }

        // === JOGO DA VELHA ===
        function initVelha() {
            const board = document.getElementById('velha-board');
            board.innerHTML = '';
            for(let i=0; i<9; i++) {
                const c = document.createElement('div');
                c.className = 'velha-cell';
                c.onclick = () => jogarVelha(i);
                c.id = `v-${i}`;
                board.appendChild(c);
            }

            db.ref('games/velha').on('value', snap => {
                const data = snap.val() || { grid: Array(9).fill(''), turn: 'THIAGO' };
                
                // Atualiza visual
                data.grid.forEach((v, i) => {
                    const el = document.getElementById(`v-${i}`);
                    el.innerText = v;
                    el.className = `velha-cell ${v.toLowerCase()}`;
                });

                document.getElementById('velha-status').innerText = 
                    data.turn === MEU_NOME ? "SUA VEZ!" : `VEZ DE ${data.turn}`;
                document.getElementById('velha-status').style.color = 
                    data.turn === MEU_NOME ? "#0f0" : "#aaa";

                // Checa Fim
                if(!MODAL_ABERTO) {
                    const vencedor = checkWinner(data.grid);
                    if(vencedor) {
                        mostrarAviso("FIM DE JOGO!", `O JOGADOR ${vencedor} VENCEU!`, "üèÜ", "var(--cor-azul)");
                    } else if(!data.grid.includes('')) {
                        mostrarAviso("TRAVOU!", "O JOGO EMPATOU (DEU VELHA)", "ü§ù", "var(--cor-rosa)");
                    }
                }
            });
        }

        function jogarVelha(i) {
            db.ref('games/velha').once('value', snap => {
                const data = snap.val() || { grid: Array(9).fill(''), turn: 'THIAGO' };
                if(data.grid[i] !== '' || data.turn !== MEU_NOME || checkWinner(data.grid)) return;

                data.grid[i] = MEU_NOME === 'THIAGO' ? 'X' : 'O';
                data.turn = MEU_NOME === 'THIAGO' ? 'SAMELLA' : 'THIAGO';
                db.ref('games/velha').set(data);
            });
        }

        function resetVelha() {
            db.ref('games/velha').set({ grid: Array(9).fill(''), turn: 'THIAGO' });
        }

        function checkWinner(grid) {
            const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
            for(let w of wins) {
                if(grid[w[0]] && grid[w[0]] === grid[w[1]] && grid[w[0]] === grid[w[2]]) return grid[w[0]];
            }
            return null;
        }

        // === FORCA B√çBLICA ===
        const PALAVRAS = ["BIBLIA", "JESUS", "IGREJA", "SALMO", "CRUZ", "PROFETA", "MILAGRE", "DANIEL", "ARCA", "EDEN"];

        function initForca() {
            const kb = document.getElementById('forca-teclado');
            kb.innerHTML = '';
            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('').forEach(l => {
                const b = document.createElement('button');
                b.className = 'tecla'; b.innerText = l; b.id = `fk-${l}`;
                b.onclick = () => chutarForca(l);
                kb.appendChild(b);
            });

            db.ref('games/forca').on('value', snap => {
                const data = snap.val();
                if(!data) { resetForca(); return; }

                const chutes = data.chutes || [];
                const palavra = data.palavra;
                
                // Visual Palavra
                const display = palavra.split('').map(l => chutes.includes(l) ? l : "_").join(' ');
                document.getElementById('forca-palavra').innerText = display;

                // Visual Teclado
                document.querySelectorAll('.tecla').forEach(b => b.disabled = false);
                chutes.forEach(l => {
                    const btn = document.getElementById(`fk-${l}`);
                    if(btn) btn.disabled = true;
                });

                // Visual Vidas
                const erros = chutes.filter(c => !palavra.includes(c)).length;
                let coracoes = "‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è".substring(0, (6-erros)*2); // Cada cora√ß√£o s√£o 2 chars utf-16
                if(erros >= 6) coracoes = "üíî";
                document.getElementById('forca-vidas').innerText = coracoes;

                // Checa Fim
                if(!MODAL_ABERTO) {
                    if(!display.includes('_')) {
                        mostrarAviso("GL√ìRIA!", "VOC√äS ACERTARAM A PALAVRA!", "üôå", "var(--cor-verde)");
                    } else if(erros >= 6) {
                        mostrarAviso("N√ÉO FOI DESSA VEZ", `A PALAVRA ERA: ${palavra}`, "üìñ", "var(--cor-rosa)");
                    }
                }
            });
        }

        function chutarForca(l) {
            db.ref('games/forca').transaction(d => {
                if(d && d.chutes && !d.chutes.includes(l)) d.chutes.push(l);
                return d;
            });
        }

        function resetForca() {
            const nova = PALAVRAS[Math.floor(Math.random() * PALAVRAS.length)];
            db.ref('games/forca').set({ palavra: nova, chutes: [] });
        }

        // === TERMO ===
        const P_TERMO = ["AMIGO","ANJOS","BENTA","CULTO","JESUS","LIVRO","MUNDO","NATAL","PADRE","SALMO"];
        function initTermo() {
            const g = document.getElementById('termo-grid');
            g.innerHTML = '';
            for(let i=0; i<6; i++) {
                const r = document.createElement('div'); r.className = 'termo-row';
                for(let j=0; j<5; j++) {
                    const b = document.createElement('div'); b.className = 'termo-box'; b.id = `tb-${i}-${j}`;
                    r.appendChild(b);
                }
                g.appendChild(r);
            }

            db.ref('games/termo').on('value', snap => {
                const data = snap.val();
                if(!data) { resetTermo(); return; }
                
                const tentativas = data.tentativas || [];
                const segredo = data.segredo;

                // Limpa tudo antes
                document.querySelectorAll('.termo-box').forEach(b => {
                    b.className = 'termo-box'; b.innerText = '';
                });

                // Preenche
                tentativas.forEach((word, i) => {
                    for(let j=0; j<5; j++) {
                        const box = document.getElementById(`tb-${i}-${j}`);
                        const l = word[j];
                        box.innerText = l;
                        if(l === segredo[j]) box.classList.add('certo');
                        else if(segredo.includes(l)) box.classList.add('lugar');
                        else box.classList.add('errado');
                    }
                });

                // Checa Fim
                if(!MODAL_ABERTO) {
                    if(tentativas.includes(segredo)) {
                        mostrarAviso("VIT√ìRIA!", "VOC√äS DESCOBRIRAM A PALAVRA!", "üéâ", "var(--cor-primaria)");
                    } else if(tentativas.length >= 6) {
                        mostrarAviso("ACABOU", `A PALAVRA ERA: ${segredo}`, "‚ùå", "var(--cor-rosa)");
                    }
                }
            });
        }

        function chutarTermo() {
            const inp = document.getElementById('termo-input');
            const val = inp.value.toUpperCase();
            if(val.length !== 5) return alert("Digite 5 letras!");
            
            db.ref('games/termo').transaction(d => {
                if(d && (!d.tentativas || d.tentativas.length < 6)) {
                    if(!d.tentativas) d.tentativas = [];
                    d.tentativas.push(val);
                }
                return d;
            });
            inp.value = '';
        }

        function resetTermo() {
            const nova = P_TERMO[Math.floor(Math.random() * P_TERMO.length)];
            db.ref('games/termo').set({ segredo: nova, tentativas: [] });
        }

        // === ADEDONHA ===
        function initAdedonha() {
            db.ref('games/adedonha/letra').on('value', snap => {
                document.getElementById('adedonha-letra').innerText = snap.val() || "?";
            });
        }
        function girarAdedonha() {
            const abc = "ABCDEFJLMNPQRSTUV";
            db.ref('games/adedonha/letra').set(abc[Math.floor(Math.random() * abc.length)]);
        }
    </script>
</body>
</html>
