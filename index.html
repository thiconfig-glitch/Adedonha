<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super App Casal Online üéÆ</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        /* === ESTILO GERAL (Fundo e Cores) === */
        :root {
            --cor-primaria: #6aaa64;
            --cor-roxo: #bd00ff;
            --cor-azul: #00f3ff;
            --cor-rosa: #ff0055;
            --cor-fundo-dark: #121213;
            --cor-card: rgba(255, 255, 255, 0.05);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; user-select: none; }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* HEADER */
        header {
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .logo { 
            font-family: 'Orbitron'; 
            font-weight: 900; 
            background: linear-gradient(90deg, var(--cor-azul), var(--cor-rosa));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.2rem;
        }
        
        .btn-voltar {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Orbitron';
            font-size: 0.8rem;
            transition: 0.3s;
        }
        .btn-voltar:active { transform: scale(0.95); background: rgba(255,255,255,0.2); }

        .hidden { display: none !important; }

        /* MENU PRINCIPAL */
        #menu-principal {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
            gap: 20px;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        .card-jogo {
            background: var(--cor-card);
            border: 1px solid rgba(255,255,255,0.1);
            width: 100%;
            padding: 25px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .card-jogo:active { transform: scale(0.98); background: rgba(255,255,255,0.1); }
        
        .card-icon { 
            font-size: 2.5rem; 
            margin-right: 20px; 
            width: 60px; 
            text-align: center;
        }
        
        .card-info h3 { font-family: 'Orbitron'; color: var(--cor-azul); margin-bottom: 5px; }
        .card-info p { font-size: 0.9rem; color: #aaa; }

        /* TELAS DE JOGO */
        .tela-jogo {
            display: none;
            flex: 1;
            flex-direction: column;
            padding: 20px;
            align-items: center;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .tela-jogo.ativa { display: flex; animation: slideUp 0.4s ease-out; }

        @keyframes slideUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }

        /* LOGIN */
        #tela-login {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: #0f0c29; z-index: 200;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 20px;
        }

        .login-card {
            background: var(--cor-card); border: 1px solid #444;
            width: 100%; max-width: 300px; padding: 30px; margin: 10px;
            border-radius: 15px; text-align: center; cursor: pointer;
            transition: 0.3s;
        }
        .login-card:active { transform: scale(0.95); border-color: var(--cor-azul); }
        .login-card h2 { font-family: 'Orbitron'; margin-top: 10px; }
        .avatar { font-size: 4rem; }

        /* BOT√ïES */
        .btn-acao {
            background: linear-gradient(135deg, var(--cor-roxo), var(--cor-rosa));
            border: none; color: white; padding: 15px 40px;
            border-radius: 30px; font-family: 'Orbitron'; font-weight: bold;
            font-size: 1.1rem; cursor: pointer; margin-top: 25px;
            box-shadow: 0 0 20px rgba(189, 0, 255, 0.4); width: 100%;
        }
        .btn-acao:active { transform: scale(0.98); }
        .btn-acao.secondary { background: #333; box-shadow: none; border: 1px solid #555; }

        /* JOGO DA VELHA */
        .velha-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; aspect-ratio: 1; }
        .velha-cell {
            background: rgba(255,255,255,0.1); border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 4rem; font-weight: bold; cursor: pointer;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        .velha-cell.x { color: var(--cor-azul); }
        .velha-cell.o { color: var(--cor-rosa); }

        /* FORCA */
        .forca-palavra { 
            font-size: 2.5rem; letter-spacing: 0.5rem; margin: 30px 0; 
            font-family: monospace; text-align: center; word-break: break-all;
        }
        .teclado { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; }
        .tecla {
            width: 35px; height: 45px; background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2); color: white;
            border-radius: 5px; font-weight: bold; cursor: pointer;
        }
        .tecla:disabled { opacity: 0.3; cursor: not-allowed; }

        /* TERMO */
        .termo-grid { display: grid; gap: 5px; margin-bottom: 20px; }
        .termo-row { display: grid; grid-template-columns: repeat(5, 50px); gap: 5px; }
        .termo-box {
            width: 50px; height: 50px; border: 2px solid #444;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; font-weight: bold; text-transform: uppercase;
        }
        .termo-box.certo { background: var(--cor-primaria); border-color: var(--cor-primaria); }
        .termo-box.lugar { background: #c9b458; border-color: #c9b458; }
        .termo-box.errado { background: #3a3a3c; border-color: #3a3a3c; }

        /* STATUS BAR */
        .status-bar {
            background: rgba(0,0,0,0.5); padding: 10px 20px; border-radius: 30px;
            margin-bottom: 20px; display: flex; gap: 15px; font-size: 0.9rem;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; background: #555; }
        .status-dot.online { background: #0f0; box-shadow: 0 0 10px #0f0; }

    </style>
</head>
<body>

    <div id="tela-login">
        <h1 style="font-family:'Orbitron'; color:var(--cor-azul); margin-bottom:40px;">QUEM √â VOC√ä?</h1>
        
        <div class="login-card" onclick="fazerLogin('THIAGO')">
            <div class="avatar">üë®üèª‚Äçüíª</div>
            <h2>THIAGO</h2>
        </div>

        <div class="login-card" onclick="fazerLogin('SAMELLA')">
            <div class="avatar">üë©üèª‚Äçüé®</div>
            <h2>S√ÇMELLA</h2>
        </div>
    </div>

    <header id="app-header" class="hidden">
        <div class="logo">üéÆ CASAL PLAY</div>
        <div style="display:flex; align-items:center; gap:10px;">
            <div id="user-badge" style="font-size:0.8rem; opacity:0.7;"></div>
            <button class="btn-voltar hidden" id="btn-voltar" onclick="voltarMenu()">SAIR DO JOGO</button>
        </div>
    </header>

    <div id="menu-principal" class="hidden">
        <div class="status-bar">
            <div class="status-dot online"></div>
            <span>Conectado como <strong id="lbl-nome">...</strong></span>
        </div>

        <div class="card-jogo" onclick="abrirJogo('adedonha')">
            <div class="card-icon">üìù</div>
            <div class="card-info">
                <h3>ADEDONHA</h3>
                <p>O cl√°ssico Stop! Quem escreve mais r√°pido?</p>
            </div>
        </div>

        <div class="card-jogo" onclick="abrirJogo('velha')">
            <div class="card-icon">‚≠ï</div>
            <div class="card-info">
                <h3>JOGO DA VELHA</h3>
                <p>Disputa r√°pida. Quem fizer a linha vence.</p>
            </div>
        </div>

        <div class="card-jogo" onclick="abrirJogo('forca')">
            <div class="card-icon">üíÄ</div>
            <div class="card-info">
                <h3>FORCA B√çBLICA</h3>
                <p>Adivinhe a palavra antes do boneco.</p>
            </div>
        </div>

        <div class="card-jogo" onclick="abrirJogo('termo')">
            <div class="card-icon">üü©</div>
            <div class="card-info">
                <h3>TERMO DUO</h3>
                <p>Descubram a palavra de 5 letras juntos.</p>
            </div>
        </div>
    </div>

    <div id="tela-velha" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-azul); margin-bottom:10px;">JOGO DA VELHA</h2>
        <p id="velha-status" style="margin-bottom:20px; color:#aaa;">Aguardando...</p>
        
        <div class="velha-grid" id="velha-board">
            </div>

        <button class="btn-acao secondary" onclick="resetVelha()">REINICIAR PARTIDA</button>
    </div>

    <div id="tela-forca" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-rosa);">FORCA</h2>
        <div id="forca-boneco" style="font-size:1.2rem; margin:10px 0; color:var(--cor-rosa);">Erros: 0/6</div>
        
        <div id="forca-palavra" class="forca-palavra">_ _ _ _ _</div>
        
        <div id="forca-teclado" class="teclado"></div>
        
        <div id="forca-msg" style="margin-top:20px; font-weight:bold;"></div>
        <button class="btn-acao secondary" onclick="resetForca()">NOVA PALAVRA</button>
    </div>

    <div id="tela-termo" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-primaria);">TERMO</h2>
        <p style="font-size:0.8rem; margin-bottom:20px; color:#aaa;">Voc√™s compartilham o mesmo tabuleiro!</p>
        
        <div id="termo-grid" class="termo-grid"></div>
        
        <div style="display:flex; gap:10px; margin-bottom:10px;">
            <input type="text" id="termo-input" maxlength="5" style="padding:10px; text-transform:uppercase; text-align:center; width:150px; font-size:1.2rem; border-radius:10px; border:none;">
            <button class="btn-acao" style="margin:0; width:auto; padding:10px 20px;" onclick="chutarTermo()">ENVIAR</button>
        </div>
        
        <div id="termo-msg" style="margin-top:10px; font-weight:bold;"></div>
        <button class="btn-acao secondary" onclick="resetTermo()">NOVO JOGO</button>
    </div>

    <div id="tela-adedonha" class="tela-jogo">
        <h2 style="font-family:'Orbitron'; color:var(--cor-roxo);">ADEDONHA</h2>
        <div style="background:#222; padding:20px; border-radius:20px; width:100%; text-align:center; margin:20px 0;">
            <div id="adedonha-letra" style="font-size:4rem; font-weight:bold; color:var(--cor-azul);">?</div>
            <p id="adedonha-status">Toque para girar</p>
        </div>
        
        <div id="adedonha-controles">
            <button class="btn-acao" onclick="girarAdedonha()">GIRAR ROLETA</button>
        </div>
        
        <div id="adedonha-inputs" class="hidden" style="width:100%;">
            <input type="text" placeholder="Nome" class="btn-acao secondary" style="margin-top:10px; text-align:left; background:#111;">
            <input type="text" placeholder="Lugar" class="btn-acao secondary" style="margin-top:10px; text-align:left; background:#111;">
            <input type="text" placeholder="Objeto" class="btn-acao secondary" style="margin-top:10px; text-align:left; background:#111;">
        </div>
    </div>

    <script>
        // === CONFIGURA√á√ÉO DO FIREBASE ===
        const firebaseConfig = {
            apiKey: "AIzaSyAjgEFZB3_FHelXH9YtCnFYFO4RCGO7Wd8",
            authDomain: "adedonha-8b2a4.firebaseapp.com",
            databaseURL: "https://adedonha-8b2a4-default-rtdb.firebaseio.com",
            projectId: "adedonha-8b2a4",
            storageBucket: "adedonha-8b2a4.firebasestorage.app",
            appId: "1:1061633793316:web:e4f9a23ce9e28ae8d2e7b1"
        };

        // Inicializa Firebase com seguran√ßa
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.database();

        // === ESTADO GLOBAL ===
        let MEU_NOME = "";
        let JOGO_ATUAL = "";
        
        // === SISTEMA DE LOGIN ===
        function fazerLogin(nome) {
            MEU_NOME = nome;
            document.getElementById('lbl-nome').innerText = nome;
            document.getElementById('user-badge').innerText = nome;
            
            // Transi√ß√£o de tela
            document.getElementById('tela-login').style.display = 'none';
            document.getElementById('app-header').classList.remove('hidden');
            document.getElementById('menu-principal').classList.remove('hidden');
        }

        function voltarMenu() {
            // Esconde jogos
            document.querySelectorAll('.tela-jogo').forEach(t => t.classList.remove('ativa'));
            document.getElementById('btn-voltar').classList.add('hidden');
            
            // Mostra menu
            document.getElementById('menu-principal').classList.remove('hidden');
            
            // Limpa listener do jogo anterior para economizar dados
            if(JOGO_ATUAL) db.ref(`games/${JOGO_ATUAL}`).off();
            JOGO_ATUAL = "";
        }

        function abrirJogo(jogo) {
            JOGO_ATUAL = jogo;
            
            document.getElementById('menu-principal').classList.add('hidden');
            document.getElementById('btn-voltar').classList.remove('hidden');
            
            document.querySelectorAll('.tela-jogo').forEach(t => t.classList.remove('ativa'));
            document.getElementById(`tela-${jogo}`).classList.add('ativa');

            // Inicia listeners espec√≠ficos
            if(jogo === 'velha') initVelha();
            if(jogo === 'forca') initForca();
            if(jogo === 'termo') initTermo();
            if(jogo === 'adedonha') initAdedonha();
        }

        // ============================================
        // 1. JOGO DA VELHA (ONLINE REAL-TIME)
        // ============================================
        function initVelha() {
            const board = document.getElementById('velha-board');
            board.innerHTML = '';
            
            // Cria tabuleiro
            for(let i=0; i<9; i++) {
                const cell = document.createElement('div');
                cell.className = 'velha-cell';
                cell.onclick = () => jogarVelha(i);
                cell.id = `v-cell-${i}`;
                board.appendChild(cell);
            }

            // Escuta mudan√ßas no Firebase
            db.ref('games/velha').on('value', snap => {
                const data = snap.val() || { grid: Array(9).fill(''), turn: 'THIAGO' };
                
                // Atualiza grid visualmente
                data.grid.forEach((val, idx) => {
                    const el = document.getElementById(`v-cell-${idx}`);
                    el.innerText = val;
                    el.className = `velha-cell ${val.toLowerCase()}`;
                });

                // Atualiza status
                const statusEl = document.getElementById('velha-status');
                if(checkWinner(data.grid)) {
                    statusEl.innerText = "FIM DE JOGO!";
                    statusEl.style.color = "var(--cor-rosa)";
                } else {
                    statusEl.innerText = data.turn === MEU_NOME ? "SUA VEZ!" : `VEZ DE ${data.turn}`;
                    statusEl.style.color = data.turn === MEU_NOME ? "#0f0" : "#aaa";
                }
            });
        }

        function jogarVelha(idx) {
            db.ref('games/velha').once('value', snap => {
                const data = snap.val() || { grid: Array(9).fill(''), turn: 'THIAGO' };
                
                // Regras de valida√ß√£o
                if(data.grid[idx] !== '') return; // J√° marcado
                if(data.turn !== MEU_NOME) return; // N√£o √© sua vez
                if(checkWinner(data.grid)) return; // J√° acabou

                // Marca jogada
                const simbolo = MEU_NOME === 'THIAGO' ? 'X' : 'O';
                data.grid[idx] = simbolo;
                data.turn = MEU_NOME === 'THIAGO' ? 'SAMELLA' : 'THIAGO';

                // Envia pro Firebase
                db.ref('games/velha').set(data);
            });
        }

        function resetVelha() {
            db.ref('games/velha').set({
                grid: Array(9).fill(''),
                turn: 'THIAGO'
            });
        }

        function checkWinner(grid) {
            const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
            return wins.some(c => grid[c[0]] && grid[c[0]] === grid[c[1]] && grid[c[0]] === grid[c[2]]);
        }

        // ============================================
        // 2. FORCA (COOPERATIVO ONLINE)
        // ============================================
        const PALAVRAS_FORCA = ["BIBLIA", "JESUS", "IGREJA", "AMOR", "CRUZ", "SALVA√á√ÉO", "BAHIA", "VIDA", "NOIVOS", "ETERNO"];

        function initForca() {
            // Cria teclado
            const kb = document.getElementById('forca-teclado');
            kb.innerHTML = '';
            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('').forEach(l => {
                const btn = document.createElement('button');
                btn.className = 'tecla';
                btn.innerText = l;
                btn.id = `key-${l}`;
                btn.onclick = () => chutarForca(l);
                kb.appendChild(btn);
            });

            // Escuta Firebase
            db.ref('games/forca').on('value', snap => {
                const data = snap.val();
                if(!data) { resetForca(); return; }

                // Atualiza palavra escondida
                const display = data.palavra.split('').map(l => (data.chutes || []).includes(l) ? l : "_").join(' ');
                document.getElementById('forca-palavra').innerText = display;
                
                // Atualiza erros
                const erros = (data.chutes || []).filter(c => !data.palavra.includes(c)).length;
                document.getElementById('forca-boneco').innerText = `Erros: ${erros}/6`;

                // Atualiza teclado (desabilita usados)
                document.querySelectorAll('.tecla').forEach(b => b.disabled = false);
                (data.chutes || []).forEach(c => {
                    const btn = document.getElementById(`key-${c}`);
                    if(btn) btn.disabled = true;
                });

                // Checa fim de jogo
                const msg = document.getElementById('forca-msg');
                if(!display.includes('_')) {
                    msg.innerText = "VOC√äS VENCERAM! üéâ";
                    msg.style.color = "#0f0";
                } else if(erros >= 6) {
                    msg.innerText = `PERDERAM! Era: ${data.palavra}`;
                    msg.style.color = "red";
                } else {
                    msg.innerText = "";
                }
            });
        }

        function chutarForca(letra) {
            db.ref('games/forca').transaction(data => {
                if(!data) return data;
                if(!data.chutes) data.chutes = [];
                if(!data.chutes.includes(letra)) data.chutes.push(letra);
                return data;
            });
        }

        function resetForca() {
            const nova = PALAVRAS_FORCA[Math.floor(Math.random() * PALAVRAS_FORCA.length)];
            db.ref('games/forca').set({
                palavra: nova,
                chutes: []
            });
        }

        // ============================================
        // 3. TERMO (COOPERATIVO ONLINE)
        // ============================================
        const PALAVRAS_TERMO = ["AMIGO","ANJOS","BENTA","CASAL","CULTO","JESUS","LIVRO","MUNDO","NATAL","PADRE"];

        function initTermo() {
            const grid = document.getElementById('termo-grid');
            grid.innerHTML = '';
            for(let i=0; i<6; i++) {
                const row = document.createElement('div');
                row.className = 'termo-row';
                for(let j=0; j<5; j++) {
                    const box = document.createElement('div');
                    box.className = 'termo-box';
                    box.id = `t-${i}-${j}`;
                    row.appendChild(box);
                }
                grid.appendChild(row);
            }

            db.ref('games/termo').on('value', snap => {
                const data = snap.val();
                if(!data) { resetTermo(); return; }

                // Renderiza tentativas anteriores
                (data.tentativas || []).forEach((tentativa, rowIdx) => {
                    for(let i=0; i<5; i++) {
                        const box = document.getElementById(`t-${rowIdx}-${i}`);
                        const letra = tentativa[i];
                        box.innerText = letra;
                        
                        // Cores
                        if(letra === data.segredo[i]) box.classList.add('certo');
                        else if(data.segredo.includes(letra)) box.classList.add('lugar');
                        else box.classList.add('errado');
                    }
                });
            });
        }

        function chutarTermo() {
            const input = document.getElementById('termo-input');
            const chute = input.value.toUpperCase();
            if(chute.length !== 5) return alert("Precisa de 5 letras!");

            db.ref('games/termo').transaction(data => {
                if(!data) return data;
                if(!data.tentativas) data.tentativas = [];
                if(data.tentativas.length < 6) data.tentativas.push(chute);
                return data;
            });
            input.value = '';
        }

        function resetTermo() {
            const nova = PALAVRAS_TERMO[Math.floor(Math.random() * PALAVRAS_TERMO.length)];
            db.ref('games/termo').set({
                segredo: nova,
                tentativas: []
            });
        }

        // ============================================
        // 4. ADEDONHA (R√ÅPIDA)
        // ============================================
        function initAdedonha() {
            db.ref('games/adedonha').on('value', snap => {
                const data = snap.val() || {};
                document.getElementById('adedonha-letra').innerText = data.letra || "?";
            });
        }

        function girarAdedonha() {
            const abc = "ABCDEFJLMNPQRSTUV";
            const letra = abc[Math.floor(Math.random() * abc.length)];
            db.ref('games/adedonha/letra').set(letra);
        }

    </script>
</body>
</html>
